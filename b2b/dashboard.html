<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>대시보드 - 무비서 B2B Console</title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --bg-primary: #0f172a;
        --bg-secondary: #1e293b;
        --bg-card: #1e293b;
        --bg-hover: #334155;
        --accent: #2a4dc4;
        --accent-light: #3b5fd9;
        --accent-dark: #1e3a8a;
        --text-primary: #f8fafc;
        --text-secondary: #94a3b8;
        --text-muted: #64748b;
        --border: #334155;
        --success: #10b981;
        --warning: #f59e0b;
        --error: #ef4444;
      }

      body {
        font-family: "Noto Sans KR", sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        min-height: 100vh;
      }

      .layout {
        display: flex;
        min-height: 100vh;
      }

      /* Sidebar */
      .sidebar {
        width: 260px;
        background: var(--bg-secondary);
        border-right: 1px solid var(--border);
        padding: 24px 0;
        position: fixed;
        height: 100vh;
        overflow-y: auto;
      }

      .sidebar-logo {
        padding: 0 24px 24px;
        border-bottom: 1px solid var(--border);
        margin-bottom: 24px;
      }

      .sidebar-logo h1 {
        font-size: 20px;
        font-weight: 700;
      }

      .sidebar-logo h1 span {
        color: var(--accent);
      }

      .sidebar-logo p {
        font-size: 12px;
        color: var(--text-muted);
        margin-top: 4px;
      }

      .sidebar-nav {
        list-style: none;
      }

      .sidebar-nav a {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 24px;
        color: var(--text-secondary);
        text-decoration: none;
        font-size: 14px;
        transition: all 0.2s;
      }

      .sidebar-nav a:hover {
        background: var(--bg-hover);
        color: var(--text-primary);
      }

      .sidebar-nav a.active {
        background: rgba(42, 77, 196, 0.1);
        color: var(--accent);
        border-right: 3px solid var(--accent);
      }

      .sidebar-nav .icon {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .sidebar-section {
        padding: 16px 24px 8px;
        font-size: 11px;
        font-weight: 600;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      /* Main Content */
      .main {
        flex: 1;
        margin-left: 260px;
      }

      /* Header */
      .header {
        background: var(--bg-secondary);
        border-bottom: 1px solid var(--border);
        padding: 16px 32px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 10;
      }

      .header h2 {
        font-size: 18px;
        font-weight: 600;
      }

      .header-user {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .header-user .plan-badge {
        background: rgba(42, 77, 196, 0.2);
        color: var(--accent-light);
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 500;
      }

      .header-user .user-info {
        text-align: right;
      }

      .header-user .user-name {
        font-size: 14px;
        font-weight: 500;
      }

      .header-user .user-email {
        font-size: 12px;
        color: var(--text-muted);
      }

      .header-user .avatar {
        width: 40px;
        height: 40px;
        background: var(--accent);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 16px;
      }

      /* Content */
      .content {
        padding: 32px;
      }

      /* Stats Cards */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin-bottom: 32px;
      }

      .stat-card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 20px;
      }

      .stat-card .label {
        font-size: 13px;
        color: var(--text-secondary);
        margin-bottom: 8px;
      }

      .stat-card .value {
        font-size: 28px;
        font-weight: 700;
      }

      .stat-card .change {
        font-size: 12px;
        margin-top: 8px;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .stat-card .change.up {
        color: var(--success);
      }

      .stat-card .change.down {
        color: var(--error);
      }

      /* API Key Card */
      .api-key-card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 32px;
      }

      .api-key-card .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
      }

      .api-key-card h3 {
        font-size: 16px;
        font-weight: 600;
      }

      .api-key-display {
        display: flex;
        align-items: center;
        gap: 12px;
        background: var(--bg-primary);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 12px 16px;
      }

      .api-key-display code {
        font-family: "JetBrains Mono", monospace;
        font-size: 14px;
        color: var(--text-primary);
        flex: 1;
      }

      .api-key-display .btn-copy {
        background: var(--accent);
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 6px;
        font-size: 13px;
        cursor: pointer;
        transition: background 0.2s;
      }

      .api-key-display .btn-copy:hover {
        background: var(--accent-light);
      }

      /* Grid Layout */
      .grid-2 {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 24px;
      }

      /* Usage Chart */
      .chart-card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 24px;
      }

      .chart-card h3 {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 20px;
      }

      .chart-container {
        height: 200px;
        position: relative;
      }

      .chart-canvas {
        width: 100%;
        height: 100%;
      }

      .chart-labels {
        display: flex;
        justify-content: space-between;
        margin-top: 12px;
        padding: 0 10px;
      }

      .chart-labels span {
        font-size: 11px;
        color: var(--text-muted);
      }

      /* Quick Actions */
      .quick-actions {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 24px;
      }

      .quick-actions h3 {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 16px;
      }

      .action-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .action-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: var(--bg-primary);
        border: 1px solid var(--border);
        border-radius: 8px;
        color: var(--text-secondary);
        text-decoration: none;
        font-size: 14px;
        transition: all 0.2s;
      }

      .action-item:hover {
        border-color: var(--accent);
        color: var(--text-primary);
      }

      .action-item .icon {
        width: 32px;
        height: 32px;
        background: rgba(42, 77, 196, 0.1);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--accent);
        font-size: 14px;
      }

      /* Responsive */
      @media (max-width: 1200px) {
        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
        }
        .grid-2 {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .sidebar {
          display: none;
        }
        .main {
          margin-left: 0;
        }
        .stats-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="layout">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-logo">
          <h1>무비서 <span>B2B</span></h1>
          <p>Console</p>
        </div>

        <nav>
          <ul class="sidebar-nav">
            <li>
              <a href="dashboard.html" class="active">
                <span class="icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7" rx="1"/>
                    <rect x="14" y="3" width="7" height="7" rx="1"/>
                    <rect x="3" y="14" width="7" height="7" rx="1"/>
                    <rect x="14" y="14" width="7" height="7" rx="1"/>
                  </svg>
                </span>
                대시보드
              </a>
            </li>
            <li>
              <a href="api-keys.html">
                <span class="icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
                  </svg>
                </span>
                API Key 관리
              </a>
            </li>
            <li>
              <a href="usage.html">
                <span class="icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 3v18h18"/>
                    <path d="M18 17V9"/>
                    <path d="M13 17V5"/>
                    <path d="M8 17v-3"/>
                  </svg>
                </span>
                사용량 리포트
              </a>
            </li>
            <li>
              <a href="playground.html">
                <span class="icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
                  </svg>
                </span>
                API Playground
              </a>
            </li>
          </ul>

          <div class="sidebar-section">설정</div>
          <ul class="sidebar-nav">
            <li>
              <a href="#">
                <span class="icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                  </svg>
                </span>
                계정 설정
              </a>
            </li>
            <li>
              <a href="#">
                <span class="icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <path d="M14 2v6h6"/>
                    <path d="M16 13H8"/>
                    <path d="M16 17H8"/>
                    <path d="M10 9H8"/>
                  </svg>
                </span>
                API 문서
              </a>
            </li>
            <li>
              <a href="#" id="logoutBtn">
                <span class="icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                    <polyline points="16 17 21 12 16 7"/>
                    <line x1="21" y1="12" x2="9" y2="12"/>
                  </svg>
                </span>
                로그아웃
              </a>
            </li>
          </ul>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="main">
        <header class="header">
          <h2>대시보드</h2>
          <div class="header-user">
            <span class="plan-badge">Pro Plan</span>
            <div class="user-info">
              <div class="user-name" id="userName">데모 기업</div>
              <div class="user-email" id="userEmail">demo@example.com</div>
            </div>
            <div class="avatar" id="userAvatar">D</div>
          </div>
        </header>

        <div class="content">
          <!-- Stats -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="label">이번 달 API 호출</div>
              <div class="value" id="monthlyCount">0</div>
              <div class="change up">+23% 전월 대비</div>
            </div>
            <div class="stat-card">
              <div class="label">오늘 호출</div>
              <div class="value" id="todayCount">0</div>
              <div class="change up">+12% 어제 대비</div>
            </div>
            <div class="stat-card">
              <div class="label">평균 응답 시간</div>
              <div class="value"><span id="avgResponse">0</span><span style="font-size: 14px; color: var(--text-muted);">ms</span></div>
              <div class="change down">-5ms 개선</div>
            </div>
            <div class="stat-card">
              <div class="label">남은 호출량</div>
              <div class="value" id="remainingCount">0</div>
              <div class="change" style="color: var(--text-muted);">/ 50,000</div>
            </div>
          </div>

          <!-- API Key -->
          <div class="api-key-card">
            <div class="card-header">
              <h3>활성 API Key</h3>
              <a href="api-keys.html" style="color: var(--accent); font-size: 14px; text-decoration: none;">관리하기 →</a>
            </div>
            <div class="api-key-display">
              <code id="apiKey">sk-moviesir-xxxx-xxxx-xxxx-xxxxxxxxxxxx</code>
              <button class="btn-copy" onclick="copyApiKey()">복사</button>
            </div>
          </div>

          <!-- Chart & Quick Actions -->
          <div class="grid-2">
            <div class="chart-card">
              <h3>최근 7일 API 호출량</h3>
              <div class="chart-container">
                <canvas id="chartCanvas" class="chart-canvas"></canvas>
              </div>
              <div class="chart-labels">
                <span>월</span>
                <span>화</span>
                <span>수</span>
                <span>목</span>
                <span>금</span>
                <span>토</span>
                <span>오늘</span>
              </div>
            </div>

            <div class="quick-actions">
              <h3>빠른 실행</h3>
              <div class="action-list">
                <a href="playground.html" class="action-item">
                  <div class="icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
                    </svg>
                  </div>
                  <span>API 테스트하기</span>
                </a>
                <a href="api-keys.html" class="action-item">
                  <div class="icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
                    </svg>
                  </div>
                  <span>새 API Key 발급</span>
                </a>
                <a href="#" class="action-item">
                  <div class="icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                      <path d="M14 2v6h6"/>
                    </svg>
                  </div>
                  <span>API 문서 보기</span>
                </a>
                <a href="#" class="action-item">
                  <div class="icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                    </svg>
                  </div>
                  <span>기술 지원 문의</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script>
      // Check login
      const user = JSON.parse(localStorage.getItem('b2b_user'));
      if (!user) {
        window.location.href = 'login.html';
      } else {
        document.getElementById('userName').textContent = user.company;
        document.getElementById('userEmail').textContent = user.email;
        document.getElementById('userAvatar').textContent = user.company.charAt(0);
      }

      // Animate counters
      function animateCounter(id, target, duration = 1500) {
        const el = document.getElementById(id);
        const start = 0;
        const startTime = performance.now();

        function update(currentTime) {
          const elapsed = currentTime - startTime;
          const progress = Math.min(elapsed / duration, 1);
          const eased = 1 - Math.pow(1 - progress, 3);
          const current = Math.floor(start + (target - start) * eased);
          el.textContent = current.toLocaleString();

          if (progress < 1) {
            requestAnimationFrame(update);
          }
        }
        requestAnimationFrame(update);
      }

      // Start counter animations
      setTimeout(() => {
        animateCounter('monthlyCount', 12847);
        animateCounter('todayCount', 1234);
        animateCounter('avgResponse', 87);
        animateCounter('remainingCount', 37153);
      }, 300);

      // Draw animated chart
      function drawChart() {
        const canvas = document.getElementById('chartCanvas');
        const ctx = canvas.getContext('2d');
        const dpr = window.devicePixelRatio || 1;

        canvas.width = canvas.offsetWidth * dpr;
        canvas.height = canvas.offsetHeight * dpr;
        ctx.scale(dpr, dpr);

        const width = canvas.offsetWidth;
        const height = canvas.offsetHeight;
        const data = [1234, 1567, 890, 2100, 1800, 1400, 1507];
        const maxValue = Math.max(...data) * 1.2;
        const barWidth = (width - 80) / data.length;
        const gap = 12;

        let animationProgress = 0;

        function animate() {
          ctx.clearRect(0, 0, width, height);

          // Draw grid lines
          ctx.strokeStyle = '#334155';
          ctx.lineWidth = 1;
          for (let i = 0; i <= 4; i++) {
            const y = height - (height * i / 4) - 10;
            ctx.beginPath();
            ctx.moveTo(40, y);
            ctx.lineTo(width - 20, y);
            ctx.stroke();
          }

          // Draw bars
          data.forEach((value, index) => {
            const barHeight = (value / maxValue) * (height - 30) * animationProgress;
            const x = 50 + index * barWidth;
            const y = height - barHeight - 10;

            // Gradient
            const gradient = ctx.createLinearGradient(x, y, x, height - 10);
            gradient.addColorStop(0, '#3b5fd9');
            gradient.addColorStop(1, 'rgba(42, 77, 196, 0.3)');

            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.roundRect(x + gap/2, y, barWidth - gap, barHeight, [4, 4, 0, 0]);
            ctx.fill();

            // Value label
            if (animationProgress > 0.8) {
              ctx.fillStyle = '#94a3b8';
              ctx.font = '11px Noto Sans KR';
              ctx.textAlign = 'center';
              ctx.fillText(value.toLocaleString(), x + barWidth/2, y - 8);
            }
          });

          if (animationProgress < 1) {
            animationProgress += 0.03;
            requestAnimationFrame(animate);
          }
        }

        setTimeout(animate, 500);
      }

      // Initialize chart
      drawChart();
      window.addEventListener('resize', drawChart);

      // Copy API Key
      function copyApiKey() {
        const key = document.getElementById('apiKey').textContent;
        navigator.clipboard.writeText(key).then(() => {
          const btn = document.querySelector('.btn-copy');
          btn.textContent = '복사됨!';
          setTimeout(() => {
            btn.textContent = '복사';
          }, 2000);
        });
      }

      // Logout
      document.getElementById('logoutBtn').addEventListener('click', function(e) {
        e.preventDefault();
        localStorage.removeItem('b2b_user');
        window.location.href = 'login.html';
      });
    </script>
  </body>
</html>
